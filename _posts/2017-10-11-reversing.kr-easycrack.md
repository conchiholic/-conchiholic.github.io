---
layout: post
title: "[reversing.kr] Easy Crack"
date: 2017-10-11
author: conchi
categories: Reversing Wargame
---

오랫만에 포스팅을 올리는 콘치입니다요 'ㅅ'/  
마지막글을 끝으로 한달동안 사라졌네요  
그동안 이런저런 많은 개인적인 사정들이 있었고 결정적으로  
그동안 분석하던 자료 + 샘플 + 환경 vm 들이 들어있던 외장하드가  
예고도 없이 갑자기! ★날★아★갔★습★니★다★!  
<br>

![1](/assets/easycrack/1.jpg)    

ㅎㅎ... ** ..
살기싫타.. ★
<br>

그래서 중간에 잠깐 쓰려던 **dll injection에 관한 고찰** 에 대한 글은 잠시 보류해두고  
당분간은 워게임이나 풀면서.. 정신을 차리는걸로..   
(변태같이 dll injection에 꽂혀버려따 ㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋ 망했으면)  

- - -
*라업이란 본디 대충쓰는것.. ★*  

![1](/assets/easycrack/2.JPG)  
reversing.kr 로가서 해당 문제를 클릭하면 작고 카와이한 바이너리가 떨어진다.  
(풀기전에는 그냥 하얀색 네모임. 그렇다. 풀었다고 자랑하는거당.)  
<br>

32bit PE 바이너리 이며, 실행하면 다음과 같은 창이 등장한다.  
<br>

![1](/assets/easycrack/3.JPG)  
저기다가 뭘 입력하고 확인을 누르면
<br>

![1](/assets/easycrack/4.JPG)  
틀렸다고 뜬다. 이제 저기에 뜬 Incorrect Password를 이용하여 문제를 해결해보자.  
<br>

![1](/assets/easycrack/5.JPG)    
IDA에 올려보면 이렇게 제대로된 뭔가를 넣으면 Congratulation !! 이라는 메세지도 출력할줄아는 녀석이라는걸 확인할 수 있다. 이제 어떻게 해야 저 메세지를 출력할 수 있을지 찾아보자.  
<br>

근데 그냥 내 개인적인 생각인데 이 문제의 경우는 IDA로 보는거보다 올리로 보는게 훨씬 편했다. 그래서 그냥 올리에서 어떻게 풀었는지 대충 설명하기로 마음먹었다. IDA에서는 어디서부터 메인 코드가 시작되는지, 확인해야하는 코드의 위치만 확인해두기로 한다.  
<br>

![1](/assets/easycrack/6.JPG)    
메인 코드가 시작되는부분에 브레이크 포인트를 걸어주고 넘어가면 저렇게 창이뜨고 내가 값을 입력할 수 있게 된다. 저기다가 아무런 값이나 넣어주자.
<br>

![1](/assets/easycrack/7.JPG)    
한줄씩 트레이싱 하다보면 첫번째 CMP명령을 만날 수 있는데 여기서 SS:[ESP+5] 에 있는 무언가와 61을 비교하는 부분을 발견할 수 있다. SS:[ESP+5]에는 뭐가 있는지는 아래쪽에 있는 작은 창에서 확인가능하다.  
<br>

![1](/assets/easycrack/8.JPG)    
62 = 'b'라고 한다. 아까 내가 처음 인풋을 넣을때 abcdefg라고 넣었는데 그중 두번째인 b가 들어갔나 보다. 그 b와 61을 비교한다는데... 'ㅅ'.. 두번째 자리에는 61에 대한 문자열이 들어가야한다는 소리가 되겠다.  이말은 결국 esp + x 가 어떤값들과 비교되는지만 찾으면 답을 구할 수 있단 소리가 되겄다.  
<br>

![1](/assets/easycrack/9.jpg)    
ㅇㅇ.. 체크해둔부분을 정리하면 다음과같다.  
<br>

![1](/assets/easycrack/10.png)    
ㅇㅇ.. 이대로 입력해주면... ㅎㅎ.. a...
끝!
